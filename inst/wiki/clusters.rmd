## Clusters in cda
A cluster of particles (dipole scatterers) is defined in 3 dimensions by a list with 3 components: positions of the dipoles; Euler angles to orient the polarizability tensor in space; and sizes of the particles (3 semi-axes for ellipsoids). Functions are provided for a few types of common clusters, as well as for their visualisation in 3D using OpenGl or povray.

```{r load,message=FALSE}
library(cda)
library(rgl)
```
```{r setup,echo=FALSE}
knit_hooks$set(rgl = function(before, options, envir) {
  # if a device was opened before this chunk, close it
  if (before && rgl.cur() > 0) rgl.close()
  hook_rgl(before, options, envir)
})
```


### Manually defining a cluster
```{r manual, rgl=TRUE,echo=1:3,tidy=FALSE}
cl1 <- list(r = rbind(c(0, 0, 0),
                      c(0, 500, 0)),
            angles = rbind(c(0, pi/2, 0),
                           c(0, pi/2, pi/3)),
            sizes = rbind(c(50, 20, 20),
                          c(40, 30, 30)))

rgl.ellipsoids(cl1$r, cl1$sizes, cl1$angles, col="gold")
axes3d( labels = FALSE, tick = FALSE, edges=c("x", "y", "z") )
axis3d(labels = FALSE, tick = FALSE, 'x',pos=c(NA, 0, 0))
axis3d(labels = FALSE, tick = FALSE, 'y',pos=c(0, NA, 0))
axis3d(labels = FALSE, tick = FALSE, 'z',pos=c(0, 0, NA))
title3d('','','x axis','y axis','z axis')
                      
```

### Predefined clusters

```{r dimer, rgl=TRUE,echo=1:3,tidy=FALSE}
cl2 <- cluster_dimer(d=100, 
                          dihedral=45*pi/180, alpha1=10*pi/180, alpha2=0,
                          a=35, b=12, 
                          right=TRUE)

rgl.ellipsoids(cl2$r, cl2$sizes, cl2$angles, col="gold")
axes3d( labels = FALSE, tick = FALSE, edges=c("x", "y", "z") )
axis3d(labels = FALSE, tick = FALSE, 'x',pos=c(NA, 0, 0))
axis3d(labels = FALSE, tick = FALSE, 'y',pos=c(0, NA, 0))
axis3d(labels = FALSE, tick = FALSE, 'z',pos=c(0, 0, NA))
title3d('','','x axis','y axis','z axis')
```


